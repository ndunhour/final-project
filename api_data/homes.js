"use strict";

var topics = [
    [
      "2015-09-30", // Date
      1080750       // Value
    ],
    [
      "2015-08-31",
      1138750
    ],
    [
      "2015-07-31",
      1124000
    ],
    [
      "2015-06-30",
      1155000
    ],
    [
      "2015-05-31",
      1125350
    ],
    [
      "2015-04-30",
      1115500
    ],
    [
      "2015-03-31",
      1180250
    ],
    [
      "2015-02-28",
      1020875
    ],
    [
      "2015-01-31",
      963250
    ],
    [
      "2014-12-31",
      1002000
    ],
    [
      "2014-11-30",
      1023250
    ],
    [
      "2014-10-31",
      971000
    ],
    [
      "2014-09-30",
      954000
    ],
    [
      "2014-08-31",
      967750
    ],
    [
      "2014-07-31",
      988450
    ],
    [
      "2014-06-30",
      966550
    ],
    [
      "2014-05-31",
      949000
    ],
    [
      "2014-04-30",
      941000
    ],
    [
      "2014-03-31",
      943500
    ],
    [
      "2014-02-28",
      894100
    ],
    [
      "2014-01-31",
      867000
    ],
    [
      "2013-12-31",
      844650
    ],
    [
      "2013-11-30",
      877750
    ],
    [
      "2013-10-31",
      849750
    ],
    [
      "2013-09-30",
      832500
    ],
    [
      "2013-08-31",
      841500
    ],
    [
      "2013-07-31",
      849500
    ],
    [
      "2013-06-30",
      859825
    ],
    [
      "2013-05-31",
      859675
    ],
    [
      "2013-04-30",
      826250
    ],
    [
      "2013-03-31",
      792750
    ],
    [
      "2013-02-28",
      759450
    ],
    [
      "2013-01-31",
      757700
    ],
    [
      "2012-12-31",
      775350
    ],
    [
      "2012-11-30",
      787250
    ],
    [
      "2012-10-31",
      784500
    ],
    [
      "2012-09-30",
      743000
    ],
    [
      "2012-08-31",
      740000
    ],
    [
      "2012-07-31",
      744500
    ],
    [
      "2012-06-30",
      738325
    ],
    [
      "2012-05-31",
      719425
    ],
    [
      "2012-04-30",
      704250
    ],
    [
      "2012-03-31",
      670100
    ],
    [
      "2012-02-29",
      645650
    ],
    [
      "2012-01-31",
      620500
    ],
    [
      "2011-12-31",
      626000
    ],
    [
      "2011-11-30",
      643500
    ],
    [
      "2011-10-31",
      654850
    ],
    [
      "2011-09-30",
      657150
    ],
    [
      "2011-08-31",
      674850
    ],
    [
      "2011-07-31",
      702250
    ],
    [
      "2011-06-30",
      709450
    ],
    [
      "2011-05-31",
      713550
    ],
    [
      "2011-04-30",
      694000
    ],
    [
      "2011-03-31",
      650600
    ],
    [
      "2011-02-28",
      634500
    ],
    [
      "2011-01-31",
      664100
    ],
    [
      "2010-12-31",
      695325
    ],
    [
      "2010-11-30",
      701650
    ],
    [
      "2010-10-31",
      688000
    ],
    [
      "2010-09-30",
      693750
    ],
    [
      "2010-08-31",
      716250
    ],
    [
      "2010-07-31",
      731500
    ],
    [
      "2010-06-30",
      735250
    ],
    [
      "2010-05-31",
      722250
    ],
    [
      "2010-04-30",
      722625
    ],
    [
      "2010-03-31",
      686125
    ],
    [
      "2010-02-28",
      670000
    ],
    [
      "2010-01-31",
      683750
    ],
    [
      "2009-12-31",
      718350
    ],
    [
      "2009-11-30",
      715900
    ],
    [
      "2009-10-31",
      724975
    ],
    [
      "2009-09-30",
      709750
    ],
    [
      "2009-08-31",
      706900
    ],
    [
      "2009-07-31",
      711350
    ],
    [
      "2009-06-30",
      703700
    ],
    [
      "2009-05-31",
      688150
    ],
    [
      "2009-04-30",
      677400
    ],
    [
      "2009-03-31",
      662750
    ],
    [
      "2009-02-28",
      670250
    ],
    [
      "2009-01-31",
      653250
    ],
    [
      "2008-12-31",
      701850
    ],
    [
      "2008-11-30",
      714650
    ],
    [
      "2008-10-31",
      737750
    ],
    [
      "2008-09-30",
      753750
    ],
    [
      "2008-08-31",
      774000
    ],
    [
      "2008-07-31",
      771450
    ],
    [
      "2008-06-30",
      789550
    ],
    [
      "2008-05-31",
      801400
    ],
    [
      "2008-04-30",
      782850
    ],
    [
      "2008-03-31",
      766250
    ],
    [
      "2008-02-29",
      766750
    ],
    [
      "2008-01-31",
      775000
    ],
    [
      "2007-12-31",
      792100
    ],
    [
      "2007-11-30",
      820650
    ],
    [
      "2007-10-31",
      826750
    ],
    [
      "2007-09-30",
      822250
    ],
    [
      "2007-08-31",
      822750
    ],
    [
      "2007-07-31",
      818250
    ],
    [
      "2007-06-30",
      831350
    ],
    [
      "2007-05-31",
      812900
    ],
    [
      "2007-04-30",
      777750
    ],
    [
      "2007-03-31",
      756000
    ],
    [
      "2007-02-28",
      755450
    ],
    [
      "2007-01-31",
      752550
    ],
    [
      "2006-12-31",
      758750
    ],
    [
      "2006-11-30",
      766000
    ],
    [
      "2006-10-31",
      770000
    ],
    [
      "2006-09-30",
      766500
    ],
    [
      "2006-08-31",
      773000
    ],
    [
      "2006-07-31",
      781250
    ],
    [
      "2006-06-30",
      784600
    ],
    [
      "2006-05-31",
      773700
    ],
    [
      "2006-04-30",
      768200
    ],
    [
      "2006-03-31",
      749000
    ],
    [
      "2006-02-28",
      739250
    ],
    [
      "2006-01-31",
      748250
    ],
    [
      "2005-12-31",
      749750
    ],
    [
      "2005-11-30",
      754500
    ],
    [
      "2005-10-31",
      755750
    ],
    [
      "2005-09-30",
      755000
    ],
    [
      "2005-08-31",
      767500
    ],
    [
      "2005-07-31",
      778000
    ],
    [
      "2005-06-30",
      760000
    ],
    [
      "2005-05-31",
      763850
    ],
    [
      "2005-04-30",
      747400
    ],
    [
      "2005-03-31",
      720500
    ],
    [
      "2005-02-28",
      709250
    ],
    [
      "2005-01-31",
      701000
    ],
    [
      "2004-12-31",
      696125
    ],
    [
      "2004-11-30",
      689925
    ],
    [
      "2004-10-31",
      685950
    ],
    [
      "2004-09-30",
      674500
    ],
    [
      "2004-08-31",
      677250
    ],
    [
      "2004-07-31",
      672250
    ],
    [
      "2004-06-30",
      667200
    ],
    [
      "2004-05-31",
      645550
    ],
    [
      "2004-04-30",
      629000
    ],
    [
      "2004-03-31",
      597750
    ],
    [
      "2004-02-29",
      569750
    ],
    [
      "2004-01-31",
      569750
    ],
    [
      "2003-12-31",
      581450
    ],
    [
      "2003-11-30",
      585525
    ],
    [
      "2003-10-31",
      579525
    ],
    [
      "2003-09-30",
      572000
    ],
    [
      "2003-08-31",
      567900
    ],
    [
      "2003-07-31",
      564850
    ],
    [
      "2003-06-30",
      574000
    ],
    [
      "2003-05-31",
      557450
    ],
    [
      "2003-04-30",
      547550
    ],
    [
      "2003-03-31",
      540000
    ],
    [
      "2003-02-28",
      543600
    ],
    [
      "2003-01-31",
      547450
    ],
    [
      "2002-12-31",
      558700
    ],
    [
      "2002-11-30",
      553750
    ],
    [
      "2002-10-31",
      544750
    ],
    [
      "2002-09-30",
      542950
    ],
    [
      "2002-08-31",
      553300
    ],
    [
      "2002-07-31",
      560500
    ],
    [
      "2002-06-30",
      563700
    ],
    [
      "2002-05-31",
      555800
    ],
    [
      "2002-04-30",
      533750
    ],
    [
      "2002-03-31",
      522250
    ],
    [
      "2002-02-28",
      496250
    ],
    [
      "2002-01-31",
      489000
    ],
    [
      "2001-12-31",
      501250
    ],
    [
      "2001-11-30",
      500500
    ],
    [
      "2001-10-31",
      493500
    ],
    [
      "2001-09-30",
      502250
    ],
    [
      "2001-08-31",
      504000
    ],
    [
      "2001-07-31",
      516500
    ],
    [
      "2001-06-30",
      525750
    ],
    [
      "2001-05-31",
      539100
    ],
    [
      "2001-04-30",
      548900
    ],
    [
      "2001-03-31",
      548250
    ],
    [
      "2001-02-28",
      516250
    ],
    [
      "2001-01-31",
      510250
    ],
    [
      "2000-12-31",
      517200
    ],
    [
      "2000-11-30",
      506150
    ],
    [
      "2000-10-31",
      500150
    ],
    [
      "2000-09-30",
      494500
    ],
    [
      "2000-08-31",
      501650
    ],
    [
      "2000-07-31",
      504000
    ],
    [
      "2000-06-30",
      510200
    ],
    [
      "2000-05-31",
      507050
    ],
    [
      "2000-04-30",
      497100
    ],
    [
      "2000-03-31",
      455750
    ],
    [
      "2000-02-29",
      431750
    ],
    [
      "2000-01-31",
      422350
    ]
  ];

var years = {};   // get the average for the years;
for (var i = 0; i < topics.length; i++) {
  var num = topics[i][0].substring(0, 4);
  if (!years[num])
    years[num] = { name: num, val: 0, count: 0 };
  years[num].count++;
  years[num].val = (years[num].val + topics[i][1]) / years[num].count;
}
var formatter = new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' });

var sales = Object.keys(years).map(function(key) { return years[key]; });
sales.reverse();    // put latest years first;
var cities = [];    // put data in cities for consistency with jobs and salaries;
var data = [
  {
    name : 'citycode_MSP',
    val : 'C00010: San Francisco'
  },
  {
    name : sales[0].name,
    val : formatter.format(sales[0].val)
  },
  {
    name : sales[1].name,
    val : formatter.format(sales[1].val)
  },
  {
    name : sales[2].name,
    val : formatter.format(sales[2].val)
  },
  {
    name : sales[3].name,
    val : formatter.format(sales[3].val)
  },
  {
    name : sales[4].name,
    val : formatter.format(sales[4].val)
  }
];
cities.push(data);

module.exports = cities;